# Syncopation

Syncopation is an open-source tool-flow that automatically instruments arbitrary circuits synthesized with LegUp HLS to enable adaptive clock management.

Our flow is integrated within the standard LegUp flow to automatically generate compatible Verilog RTL and clock management resources.

Publications available soon.

## Installing dependencies

### LegUp

LeFlow was built to be compatible with LegUp 4.0. We recommend downloading the virtual machine available at [legup.eecg.utoronto.ca](http://legup.eecg.utoronto.ca/).

### Syncopation Setup

Once this project has been cloned, you can install the Syncopation tool and dependencies using the following command:

```pip3 install -e .```

To test, type `syncopation` into the terminal to obtain the help message:

```
Syncopation

Usage:
    syncopation make <C_FILE> [--no_synth_directives | --no_sync_hardware | --pipeline]
    syncopation modelsim <C_FILE> [--log=<LOG_FILE>]
    syncopation synth <C_FILE> [--log=<LOG_FILE>] [--enhanced_synthesis | --fast]
    syncopation -h|--help

Options:
    -h --help               Show this screen
    --no_synth_directives   No annotations in generated RTL
    --no_sync_hardware      No syncopation DMs or clock generator hardware included. Equivalent to a normal Legup compile
    --pipeline              Pipeline the divisor selection logic; use conservative predict
    --enhanced_synthesis    If no enhanced synthesis constraints are found, generate them. If found, resynthesize
    --log                   Modelsim log file generated by simulation and used to assess Syncopation performance
```

### Testing your installation

To test your installation, go to the test directory and run 

```python test_all.py```

If one of the test fails, you have a problem with your installation. 

## Getting Started

### Running a single example

To get started with syncopation, try the following:

- Enter the ./test directory and select an example directory (i.e. myAdd) or any directory with a design you would like to synthesize.

- To generate Syncopation hardware from C code, run

  ```syncopation make *.c```
  
- To test generated hardware using Modelsim, run

  ```syncopation modelsim *.c```
  
- To synthesize the above example, run 

  ```syncopation synth *.c```
  
- To run synthesis with enhanced synthesis, run

  ```syncopation synth *.c --enhanced_synthesis```
  
  Once to generate the constraints file, and again run 
  
  ```syncopation synth *.c --enhanced_synthesis``` 

### Syncopation Settings

If you are interested in changing some of the default syncopation parameters, take a look at `settings.py`.

## Contents:

- src -- includes source code for syncopation
- test -- simple examples that be run to test the tool

## Contributors

* **Kahlan Gibson** - *kahlangibson-at-ece.ubc.ca* 
* **Esther Roorda**
* **Daniel Holanda Noronha**
* **Steve Wilton**

## License

This project is licensed under the MIT License - see the [LICENSE.txt](LICENSE.txt) file for details
